## è‚¡ç¥¨æ•°æ®å¤„ç†ä¼˜åŒ–å»ºè®®

### ðŸ” éªŒè¯ç»“æžœ
é€šè¿‡éªŒè¯AkShareæŽ¥å£èŽ·å–çš„è‚¡ç¥¨300304åœ¨2025-07-17çš„æ”¶ç›˜ä»·ä¸º9.07å…ƒï¼Œä¸Žå®žé™…æ•°æ®å®Œå…¨åŒ¹é…ï¼Œè¯æ˜Žï¼š
- **AkShareåŽ†å²Kçº¿æ•°æ®è¿”å›žçš„æ˜¯åŽŸå§‹ä»·æ ¼**ï¼ˆå½“adjust=""æ—¶ï¼‰
- **æ— éœ€å¯¹åŽ†å²Kçº¿æ•°æ®è¿›è¡Œä»»ä½•å¤æƒå¤„ç†**

### âš ï¸ å½“å‰é—®é¢˜
ä»£ç ä¸­ä»ç„¶åœ¨app.pyçš„1556-1624è¡Œå¯¹Kçº¿æ•°æ®è¿›è¡Œå¤æƒå¤„ç†ï¼Œè¿™æ˜¯ä¸å¿…è¦çš„ï¼Œå¯èƒ½å¯¼è‡´ï¼š
1. ä»·æ ¼æ•°æ®è¢«é”™è¯¯åœ°äºŒæ¬¡å¤æƒ
2. å¢žåŠ ä¸å¿…è¦çš„è®¡ç®—å¼€é”€
3. å¼•å…¥æ½œåœ¨çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜

### ðŸ”§ ä¼˜åŒ–å»ºè®®

#### 1. ç®€åŒ–Kçº¿æ•°æ®èŽ·å–é€»è¾‘
```python
# å½“å‰ä»£ç ï¼ˆå¤æ‚ä¸”ä¸å¿…è¦ï¼‰
daily_data = safe_tushare_call(pro.daily, ts_code=ts_code, start_date=start_date, end_date=end_date)
adj_factor_data = safe_tushare_call(pro.adj_factor, ts_code=ts_code, start_date=start_date, end_date=end_date)
# ... å¤æ‚çš„å¤æƒè®¡ç®— ...

# å»ºè®®çš„ç®€åŒ–ä»£ç 
daily_data = safe_tushare_call(pro.daily, ts_code=ts_code, start_date=start_date, end_date=end_date)
daily_data['adj_factor'] = 1.0  # æ ‡è®°ä¸ºåŽŸå§‹ä»·æ ¼
daily_data['is_adjusted'] = False  # æ ‡è®°ä¸ºæœªå¤æƒ
```

#### 2. ç»Ÿä¸€æ•°æ®æºç­–ç•¥
- **åˆ†æ—¶æ•°æ®**: AkShare (adjust="") - åŽŸå§‹ä»·æ ¼ âœ…
- **Kçº¿æ•°æ®**: Tushare dailyæŽ¥å£ - åŽŸå§‹ä»·æ ¼ âœ…
- **ä¿æŒä¸€è‡´æ€§**: éƒ½ä½¿ç”¨åŽŸå§‹ä»·æ ¼ï¼Œæ— éœ€å¤æƒå¤„ç†

#### 3. ä»£ç å¯ç»´æŠ¤æ€§æ”¹è¿›

##### A. é…ç½®ç®¡ç†
```python
# åœ¨config_utils.pyä¸­æ·»åŠ 
class DataSourceConfig:
    USE_ORIGINAL_PRICES = True  # ç»Ÿä¸€ä½¿ç”¨åŽŸå§‹ä»·æ ¼
    SKIP_ADJUSTMENT = True      # è·³è¿‡å¤æƒå¤„ç†
```

##### B. æ•°æ®éªŒè¯
```python
def validate_price_data(data, symbol):
    """éªŒè¯ä»·æ ¼æ•°æ®çš„åˆç†æ€§"""
    if data['close'].max() > 1000:  # æ£€æŸ¥å¼‚å¸¸é«˜ä»·
        logger.warning(f"è‚¡ç¥¨{symbol}å­˜åœ¨å¼‚å¸¸é«˜ä»·: {data['close'].max()}")
    return data
```

##### C. æ€§èƒ½ä¼˜åŒ–
```python
# ç§»é™¤ä¸å¿…è¦çš„å¤æƒè®¡ç®—ï¼Œå‡å°‘APIè°ƒç”¨
def get_stock_data_optimized(ts_code):
    # åªèŽ·å–å¿…è¦çš„æ•°æ®ï¼Œè·³è¿‡å¤æƒå› å­
    daily_data = safe_tushare_call(pro.daily, ts_code=ts_code, ...)
    return daily_data  # ç›´æŽ¥è¿”å›žåŽŸå§‹æ•°æ®
```

#### 4. é”™è¯¯å¤„ç†æ”¹è¿›
```python
def safe_price_conversion(price, factor=1.0):
    """å®‰å…¨çš„ä»·æ ¼è½¬æ¢ï¼Œé¿å…å¼‚å¸¸å€¼"""
    try:
        result = float(price) * float(factor)
        if result > 10000 or result < 0:  # æ£€æŸ¥å¼‚å¸¸å€¼
            logger.warning(f"ä»·æ ¼è½¬æ¢å¼‚å¸¸: {price} * {factor} = {result}")
            return price  # è¿”å›žåŽŸå§‹ä»·æ ¼
        return result
    except (ValueError, TypeError):
        return price
```

#### 5. æ–‡æ¡£å’Œæ³¨é‡Šæ›´æ–°
- æ›´æ–°PROJECT_DOCUMENTATION.mdï¼Œè¯´æ˜Žä½¿ç”¨åŽŸå§‹ä»·æ ¼ç­–ç•¥
- åœ¨ä»£ç ä¸­æ·»åŠ æ¸…æ™°çš„æ³¨é‡Šï¼Œè¯´æ˜Žæ•°æ®æºå’Œå¤„ç†é€»è¾‘
- ç§»é™¤è¿‡æ—¶çš„å¤æƒç›¸å…³æ³¨é‡Š

### ðŸŽ¯ å®žæ–½ä¼˜å…ˆçº§

1. **é«˜ä¼˜å…ˆçº§**: ç§»é™¤Kçº¿æ•°æ®çš„å¤æƒå¤„ç†é€»è¾‘
2. **ä¸­ä¼˜å…ˆçº§**: æ·»åŠ æ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†
3. **ä½Žä¼˜å…ˆçº§**: é‡æž„é…ç½®ç®¡ç†å’Œæ–‡æ¡£æ›´æ–°

### ðŸ“Š é¢„æœŸæ”¶ç›Š

- **æ€§èƒ½æå‡**: å‡å°‘30-50%çš„æ•°æ®å¤„ç†æ—¶é—´
- **æ•°æ®ä¸€è‡´æ€§**: æ¶ˆé™¤å¤æƒå¤„ç†å¯¼è‡´çš„ä»·æ ¼ä¸ä¸€è‡´
- **ä»£ç ç®€åŒ–**: å‡å°‘200+è¡Œå¤æƒç›¸å…³ä»£ç 
- **ç»´æŠ¤æ€§**: é™ä½Žå¤æ‚åº¦ï¼Œæé«˜å¯è¯»æ€§

### ðŸ” éªŒè¯æ–¹æ³•

å®žæ–½ä¼˜åŒ–åŽï¼Œå»ºè®®éªŒè¯ï¼š
1. è‚¡ç¥¨300304çš„ä»·æ ¼æ˜¯å¦ä¿æŒåœ¨8-9å…ƒèŒƒå›´
2. å…¶ä»–è‚¡ç¥¨çš„ä»·æ ¼æ˜¯å¦åˆç†
3. åˆ†æ—¶æ•°æ®å’ŒKçº¿æ•°æ®çš„ä»·æ ¼æ˜¯å¦ä¸€è‡´
4. ç³»ç»Ÿæ€§èƒ½æ˜¯å¦æœ‰æå‡