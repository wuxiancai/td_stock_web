<!DOCTYPE html>
<html>
<head>
    <title>BOLL指标测试</title>
    <script src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>
</head>
<body>
    <h1>BOLL指标测试页面</h1>
    <div>
        <label>
            <input type="checkbox" id="showBOLL" checked> 显示BOLL指标
        </label>
    </div>
    <div id="chart" style="width:100%;height:400px;"></div>
    
    <script>
        // 测试数据
        const testData = [
            {trade_date: '2024-01-01', open: 10, high: 12, low: 9, close: 11, boll_upper: 12.5, boll_mid: 10.5, boll_lower: 8.5},
            {trade_date: '2024-01-02', open: 11, high: 13, low: 10, close: 12, boll_upper: 13.0, boll_mid: 11.0, boll_lower: 9.0},
            {trade_date: '2024-01-03', open: 12, high: 14, low: 11, close: 13, boll_upper: 13.5, boll_mid: 11.5, boll_lower: 9.5}
        ];
        
        function createChart() {
            const dates = testData.map(item => item.trade_date);
            const opens = testData.map(item => item.open);
            const highs = testData.map(item => item.high);
            const lows = testData.map(item => item.low);
            const closes = testData.map(item => item.close);
            
            const traces = [];
            
            // K线图
            traces.push({
                x: dates,
                open: opens,
                high: highs,
                low: lows,
                close: closes,
                type: 'candlestick',
                name: '测试股票'
            });
            
            // BOLL指标
            const showBOLL = document.getElementById('showBOLL').checked;
            if (showBOLL) {
                const bollUpper = testData.map(item => item.boll_upper);
                const bollMid = testData.map(item => item.boll_mid);
                const bollLower = testData.map(item => item.boll_lower);
                
                // BOLL上轨
                traces.push({
                    x: dates,
                    y: bollUpper,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'BOLL上轨',
                    line: {color: '#ff6b6b', width: 1, dash: 'dot'}
                });
                
                // BOLL中轨
                traces.push({
                    x: dates,
                    y: bollMid,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'BOLL中轨',
                    line: {color: '#4ecdc4', width: 1.5}
                });
                
                // BOLL下轨
                traces.push({
                    x: dates,
                    y: bollLower,
                    type: 'scatter',
                    mode: 'lines',
                    name: 'BOLL下轨',
                    line: {color: '#45b7d1', width: 1, dash: 'dot'}
                });
            }
            
            const layout = {
                title: 'BOLL指标测试',
                xaxis: {title: '日期'},
                yaxis: {title: '价格'},
                showlegend: true
            };
            
            Plotly.newPlot('chart', traces, layout);
        }
        
        // 监听复选框变化
        document.getElementById('showBOLL').addEventListener('change', createChart);
        
        // 初始化图表
        createChart();
    </script>
</body>
</html>